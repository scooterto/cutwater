<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cutwater | Revenue & Commission</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Source+Serif+4:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --navy-primary: #1a2b5f;
            --navy-light: #2c4a8c;
            --blue-accent: #5BA4E6;
            --success: #2D8A5F;
            --warning: #c9a227;
            --bg-primary: #FFFFFF;
            --bg-secondary: #f8f9fa;
            --text-primary: #1a2b5f;
            --text-secondary: #5a6577;
            --border-color: #e8eaed;
            --font-display: 'Playfair Display', Georgia, serif;
            --font-body: 'Source Serif 4', Georgia, serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 40px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 32px;
        }

        .controls {
            display: flex;
            gap: 24px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            gap: 8px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-secondary);
            font-family: var(--font-body);
            font-size: 0.85rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-btn:hover {
            border-color: var(--navy-primary);
            color: var(--navy-primary);
        }

        .filter-btn.active {
            background: var(--navy-primary);
            color: white;
            border-color: var(--navy-primary);
        }

        .legend {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: opacity 0.2s ease;
        }

        .legend-item:hover {
            background: var(--bg-secondary);
        }

        .legend-item.disabled {
            opacity: 0.4;
        }

        .legend-color {
            width: 16px;
            height: 3px;
            border-radius: 2px;
        }

        .legend-label {
            font-size: 0.85rem;
            color: var(--text-primary);
        }

        .chart-container {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            height: 400px;
            margin-bottom: 24px;
        }

        .chart-title {
            font-family: var(--font-display);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-top: 32px;
        }

        .stat-card {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 20px;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .stat-value {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .stat-value.revenue { color: var(--success); }
        .stat-value.commission { color: var(--blue-accent); }

        .table-container {
            margin-top: 40px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .table-header h2 {
            font-family: var(--font-display);
            font-size: 1.2rem;
            font-weight: 600;
        }

        .table-scroll {
            max-height: 500px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            position: sticky;
            top: 0;
            background: var(--bg-primary);
            z-index: 10;
        }

        th, td {
            padding: 12px 16px;
            text-align: right;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.85rem;
        }

        th {
            font-weight: 600;
            color: var(--text-secondary);
            background: var(--bg-secondary);
        }

        th:first-child, td:first-child {
            text-align: left;
            padding-left: 24px;
        }

        th:last-child, td:last-child {
            padding-right: 24px;
        }

        tr:hover {
            background: var(--bg-secondary);
        }

        .revenue { color: var(--success); }
        .commission { color: var(--blue-accent); }

        @media (max-width: 768px) {
            body { padding: 20px; }
            h1 { font-size: 1.8rem; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .chart-container { height: 300px; }
            .table-scroll { max-height: 350px; }
            th, td { padding: 8px 10px; font-size: 0.75rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Revenue & Commission</h1>
        <p class="subtitle">Monthly and cumulative growth metrics for Cutwater Partners (January - November 2025)</p>

        <div class="controls">
            <div class="filter-group">
                <button class="filter-btn active" data-view="monthly">Monthly</button>
                <button class="filter-btn" data-view="cumulative">Cumulative</button>
            </div>

            <div class="legend">
                <div class="legend-item" data-series="revenue">
                    <div class="legend-color" style="background: #2D8A5F;"></div>
                    <span class="legend-label">Revenue</span>
                </div>
                <div class="legend-item" data-series="commission">
                    <div class="legend-color" style="background: #5BA4E6;"></div>
                    <span class="legend-label">Commission</span>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="revenueChart"></canvas>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Total Revenue</div>
                <div class="stat-value revenue">$310,455</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Commission</div>
                <div class="stat-value commission">$65,612</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Commission Rate</div>
                <div class="stat-value">21.1%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Peak Monthly Revenue</div>
                <div class="stat-value revenue">$113,197</div>
            </div>
        </div>

        <div class="table-container">
            <div class="table-header">
                <h2>Monthly Breakdown</h2>
                <span style="color: var(--text-secondary); font-size: 0.85rem;">11 records</span>
            </div>
            <div class="table-scroll">
                <table>
                    <thead>
                        <tr>
                            <th>Month</th>
                            <th>Commission</th>
                            <th>Cumulative Commission</th>
                            <th>Revenue</th>
                            <th>Cumulative Revenue</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Data
        const data = {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov'],
            fullLabels: ['January 2025', 'February 2025', 'March 2025', 'April 2025', 'May 2025', 'June 2025', 'July 2025', 'August 2025', 'September 2025', 'October 2025', 'November 2025'],
            commission: {
                monthly: [6147.01, 0, 2015.29, 15241.10, 12127.40, 3260.29, 5578.38, 9886.13, 6215.68, 5140.57, 0],
                cumulative: [6147.01, 6147.01, 8162.30, 23403.40, 35530.80, 38791.09, 44369.47, 54255.60, 60471.28, 65611.85, 65611.85]
            },
            revenue: {
                monthly: [0, 0, 19485.54, 25888.29, 113196.62, 16290.03, 29486.23, 49417.33, 31078.27, 25612.82, 0],
                cumulative: [0, 0, 19485.54, 45373.83, 158570.45, 174860.48, 204346.71, 253764.04, 284842.31, 310455.13, 310455.13]
            }
        };

        // Series visibility
        const seriesVisible = {
            revenue: true,
            commission: true
        };

        let currentView = 'monthly';

        // Create chart
        const ctx = document.getElementById('revenueChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: data.labels,
                datasets: [
                    {
                        label: 'Revenue',
                        data: data.revenue.monthly,
                        backgroundColor: '#2D8A5F',
                        borderRadius: 4,
                        order: 1
                    },
                    {
                        label: 'Commission',
                        data: data.commission.monthly,
                        backgroundColor: '#5BA4E6',
                        borderRadius: 4,
                        order: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    intersect: false,
                    mode: 'index'
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(26, 43, 95, 0.95)',
                        titleFont: { family: "'Source Serif 4', Georgia, serif" },
                        bodyFont: { family: "'Source Serif 4', Georgia, serif" },
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': $' + context.parsed.y.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { display: false },
                        ticks: {
                            color: '#5a6577',
                            font: { family: "'Source Serif 4', Georgia, serif" }
                        }
                    },
                    y: {
                        grid: { color: 'rgba(26, 43, 95, 0.1)' },
                        ticks: {
                            color: '#5a6577',
                            callback: value => '$' + (value / 1000).toFixed(0) + 'k',
                            font: { family: "'Source Serif 4', Georgia, serif" }
                        }
                    }
                }
            }
        });

        // View toggle (Monthly/Cumulative)
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                currentView = this.dataset.view;
                updateChart();
            });
        });

        function updateChart() {
            if (currentView === 'monthly') {
                chart.config.type = 'bar';
                chart.data.datasets[0].data = data.revenue.monthly;
                chart.data.datasets[1].data = data.commission.monthly;
                chart.data.datasets[0].backgroundColor = '#2D8A5F';
                chart.data.datasets[1].backgroundColor = '#5BA4E6';
                chart.data.datasets[0].borderColor = undefined;
                chart.data.datasets[1].borderColor = undefined;
                chart.data.datasets[0].fill = undefined;
                chart.data.datasets[1].fill = undefined;
                chart.data.datasets[0].tension = undefined;
                chart.data.datasets[1].tension = undefined;
                chart.data.datasets[0].pointRadius = undefined;
                chart.data.datasets[1].pointRadius = undefined;
            } else {
                chart.config.type = 'line';
                chart.data.datasets[0].data = data.revenue.cumulative;
                chart.data.datasets[1].data = data.commission.cumulative;
                chart.data.datasets[0].borderColor = '#2D8A5F';
                chart.data.datasets[1].borderColor = '#5BA4E6';
                chart.data.datasets[0].backgroundColor = 'rgba(45, 138, 95, 0.1)';
                chart.data.datasets[1].backgroundColor = 'rgba(91, 164, 230, 0.1)';
                chart.data.datasets[0].fill = true;
                chart.data.datasets[1].fill = true;
                chart.data.datasets[0].tension = 0.3;
                chart.data.datasets[1].tension = 0.3;
                chart.data.datasets[0].pointRadius = 4;
                chart.data.datasets[1].pointRadius = 4;
            }

            // Reapply visibility
            chart.data.datasets[0].hidden = !seriesVisible.revenue;
            chart.data.datasets[1].hidden = !seriesVisible.commission;

            chart.update();
        }

        // Legend toggle
        document.querySelectorAll('.legend-item').forEach(item => {
            item.addEventListener('click', function() {
                const series = this.dataset.series;
                seriesVisible[series] = !seriesVisible[series];
                this.classList.toggle('disabled');

                const idx = series === 'revenue' ? 0 : 1;
                chart.data.datasets[idx].hidden = !seriesVisible[series];
                chart.update();
            });
        });

        // Populate data table
        function populateTable() {
            const tbody = document.getElementById('dataTableBody');
            let html = '';

            // Show data in reverse chronological order (newest first)
            for (let i = data.labels.length - 1; i >= 0; i--) {
                const commMonthly = data.commission.monthly[i];
                const commCumulative = data.commission.cumulative[i];
                const revMonthly = data.revenue.monthly[i];
                const revCumulative = data.revenue.cumulative[i];

                html += `<tr>
                    <td>${data.fullLabels[i]}</td>
                    <td class="commission">$${commMonthly.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td class="commission">$${commCumulative.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td class="revenue">${revMonthly > 0 ? '$' + revMonthly.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) : '-'}</td>
                    <td class="revenue">${revCumulative > 0 ? '$' + revCumulative.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) : '-'}</td>
                </tr>`;
            }

            tbody.innerHTML = html;
        }
        populateTable();
    </script>
</body>
</html>
